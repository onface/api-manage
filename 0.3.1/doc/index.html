<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<link rel="stylesheet" href="theme/face/face.css">
<meta name="keywords" content="">
<meta name="description" content="better-api">
<title>better-api</title>
<!--[if lt IE 10]><script src="theme/polyfill/lt-ie10.js"></script><![endif]-->
<script src="theme/polyfill/es6-promise.js"></script>
</head>
<body>
<div class="face-one-head">
    <a class="face-one-head-logo" href="../index.html">
        <img src="theme/media/logo.svg" alt="" class="face-one-head-logo-photo" />
        <span class="face-one-head-logo-text">
        better-api
        </span>
    </a>
    <span class="face-one-head-slogan">
        前后端交互接口封装管理(AJAX HTTP)
    </span>
    <!-- <div class="face-one-head-search">
        <span class="face-one-head-search-icon fi fi-search"></span>
        <input type="text" class="face-one-head-search-input" placeholder="搜索..." />
    </div> -->
    <div class="face-one-head-nav">
        <span class="face-one-head-nav-switch fi fi-bars"></span>
        <div class="face-one-head-nav-F-cnt">
            <a href="../index.html" class="face-one-head-nav-link">首页</a>
            <a href="intro.html" class="face-one-head-nav-link">指引</a>
            <a href="index.html" class="face-one-head-nav-link">文档</a>
        </div>
        <script>
        Array.from(document.querySelectorAll('.face-one-head-nav-link')).forEach(function (node) {
            if (node.href) {
                var pathname = node.href.replace(/\?.*/, '')
                if (pathname === location.origin + location.pathname) {
                    node.setAttribute('class', node.getAttribute('class') + ' ' + 'face-one-head-nav-link--on')
                }
            }
        })
        </script>
    </div>
</div>

<div class="face-one-layout">
<div class="face-one-layout-F-line">
<div class="face-one-layout-sidebar">
<div class="face-one-nav">
<span class="face-one-nav-switch fi fi-menu-unfold"></span>
<div class="face-one-nav-F-inner">
<div class="face-one-nav-item face-one-nav-item--on">
    <a href="intro.html" class="face-one-nav-item-label">指引</a>
</div>
<!-- face-one-nav-item--group-on 控制默认展开 -->
<div class="face-one-nav-item face-one-nav-item--group face-one-nav-item--group-on">
    <span class="face-one-nav-item-switch fi fi-angle-down"></span>
    <span class="face-one-nav-item-label">
        文档
    </span>
    <div class="face-one-nav-item-group">
        <a href="index.html" class="face-one-nav-item-group-item">索引</a>
    </div>
</div>

</div>
</div>
</div>
<div class="face-one-layout-cnt">
<div id="face-one-cnt" class="face-one-cnt markdown-body">
<div id="face-one-sidebar" class="face-one-sidebar"></div>
<h1 id="better-api" ><a class="markrun-anchor" href="../Users/nimo/Documents/git/better-api/#better-api"><span class="markrun-anchor-link"></span></a>better-api</h1><h2 id="jquery" ><a class="markrun-anchor" href="../Users/nimo/Documents/git/better-api/#jquery"><span class="markrun-anchor-link"></span></a>jquery</h2>
    <div class="face-one-code   face-one-code--run  face-one-code--side">
                        <div class="face-one-code-F-view">
                            <div class="face-one-code-example">
                                <button id="jquery-pass" >pass</button> <button id="jquery-fail" >fail</button> <button id="jquery-fail-detailAction" >fail (defaultAction)</button> <hr /> <button id="jquery-net-fail" >net.fail</button> <button id="jquery-net-fail-custom" >net.fail(custom)</button> <button id="jquery-net-fail-defaultAction" >net.fail (defaultAction)</button> <hr /> <button id="jquery-abort" >abort</button> <button id="jquery-loading" >loading</button>
                            </div>
                            <div class="face-one-code-info">
                                <div class="face-one-code-info-title">jquery</div>
                                <div class="face-one-code-info-desc">
                                    
                                </div>
                                <span class="face-one-code-info-switchCode fi fi-ellipsis"></span>
                            </div>
                        </div>
                        <div class="face-one-code-source"  >
                            <div class="face-one-code-source-tool">
                                <form class="face-one-code-source-tool-preview" action="https://codesandbox.io/api/v1/sandboxes/define" method="post" target="_blank" >
                                        <input type="hidden" name="parameters" value="N4IgZglgNgpgziAXKCA7AJjAHgOgBYAuAtlEqAMYD2qBMNSIAPAEYCuBB1ABBOgLwAdEACsAjqxgAnAJ4BaAA4BDOHCFcAfEpWMA9Gw7V1XFu06oe_IWIkzZYRdDXr70XfrNGTB870EjxUnIuULKYBA5QAILkBBDUTsFcABSY9qxQBNGx1ACUbqaGxniSXDqe7ty-VgG2qDAEdhFOdQQ4wfne5QU-lv42ci2N0LLkrHCcRM31bRFJo-OURHl63V3eFn7WgbKDwaEwaRlZcahTrYkpB4rpmTEnyxWonsWla2Yb1f2yisyUkgROH5_AgdDzGR4fPrbKCURToNAAcycMLhiNBhhAAF8ADQgNCYXDCBDIEBUGh0AgMABuihKACF6rRJJEAAoASS4fC4khg4ggPKSAHJmIypN95BBBTkBKgaSUACSc7m81j8mBCrYyKUyuVcIjwOCKBEwJU8vkCwX2cgwWT6lRGmDa2W0riKCVKuoAdy4DI4UlZbKSwBlXFDXFS1wyAGVGYi4IguMHzGGU-hFOEACrSeQwBOConUQUhsM44uhlHw1AIhNgVioO7cJIQOAAGVhlYR2K4wUikgROUTZZTPDAyWbbdRVYHSeHs71BodOAriLptJwcDwlE9SQATNLk7PMUOUzAoHATTO5ym4J6IARyHhkj2-wBtACMAF1p8er2HyMoTUFIF_kFRAZR_X9h2YHlFAAawAbgg39_3PLg61SNAYHQMCD0guc7UNY0l3bFc1zwXh1X3PDf2gmA4KQq8IxuHDqKvAjF2XKtV0kGZoCSKi8KPXCUyEkTsSHNB5HYGs6wbcwkjNb9hLDHkCFYSRzDNIdS1wyh2CkggZPrbJ5J5OAu0UwdlNDVT1M0-BtPE3CwHqB8jLk5I03CLtzw4OMu3_KAoGYRRyFgpSr182IqzgHAvMUJV4qQ2yNK4eUcEUYRFCwJIorjATWK4OLqHVQLgtC2CcBaYq6gK1jeKgOZFCCkKwqq6Zgjq6iMqgT1FGkOAmpaiqMrAJk6p01MrhuABhZryrChNL1nFoloYsNgnckzkjEAANAAJAAlLtaCwAgo3CNS4AiwquBvO8HySU7zsusYbtuv8AK4QVYn1PSCFA9bCvYoipEkP4hUARX9AB2_QBQ2MAN9MnQ-lNaPo6zWJQwDgIBljkdDVHYKB38mIyXG8ZTEGYBwMGIcFGHAExUwB76KR26hKJ0S5w50NJrDYRWHQY1DvgeRqHPLMcy2k5kjM97hxS-zYvGdMxkcocSYIIW4BF1AxezXMrKvLR427WTtv4g28Mp9dWHIa0VCFQBZk0AHXlAAQjQB8pRZw8nKvTaTeMqWFPgWW2IXUHJHByQhU2wUuAAamVWKiDgfskJ52cackSXGxli3IKtjOhQzxAY_jsycCTlP0a5rghMxfddTdCAWWUOAlUbnByBg2ggyHPKYrW9H1KgPNCAIeREB0HQ3zfAAOHAdwAVhwN9F_nt8AGZEAAThnnd150agrRgHQYAfSgdCISgwp0I3BW9ucCD1vNjQB7SZTrnUXUbgAxCI24lDuXd1TLTurGfuudhxDxHhwcek9p5z1XivJeO4N7b13vvQ-oVj6n03BfK-sEdDBDvkhR-EtvovyLLhWu9cv4SgAHL1F_tAf-EBAF0W7iAvuCJjYgJTFA76OgAAsAAGQRxD0akP1oKChb9UAf2dCURuAARU8_UWFsPTMA3uYDuEDyvPwwUo9YFT1nvPJeSC16bx3nvA-qAj4nzPng6-RsAD88pMBQH6nwN8wjfHiKvJI5-9RKEiXfvueUSRaz-0bLLCJgoADEmo5C3xyDgagQpyBQAgGFO-fsPLm14WGRuzd7ZE0nuGdMigiaFMgqgRQ-o8yoAgJfEJgl76QXKWVVqhN0Yphqb-I2Wd5LB1ulbOANs7aDUFM7d2ntWJp1Yr7KJ-Sc79OovncOEMy4Vy6oJdmSEJp1TiYkmoQQIhSjSagDJWScldmWWbEZoYf6zDKToCp4RqlExTHUhp30mktPZu038nT5rdM-b0ucgy8kPIgR9ZqUgCCO1dh7XZkEFnUSWabAOqyvn4VDlTAu2zk6ot_NXK8ZKwyHKHMcpJQwQhhAiMcQsqT0mCkydk2CuT7kB0ea6CUTDGqvPeVUiFoY1lzh-VI_5lBWloqBVeEFw0wrgo-lC7lMTYWjPxdbW2BokWzJJeS-VeFMXRNMkHTVhUCDkViurJlVzDWW21QXQUABZP4JpKZPgiDkOZ1EKWHgOdpI5QoTlfF2OcllVy2U3M5XcrFGr-mNwYQQAV_Fg3UtDbSiNwx5gTAuay9ltzoU8stXyiAKa03ABxImGt4rQyrTLT7CIQzki8vWc6zZkdBSAAh_wAV4GACztQAknKAEh_hmzNHWBtFTXVOVLcI0tOTseodL9iHFuCZAt0ai1xpLYmpCybGGzGrV2Y9TawyNvrcOU1-T214Wtc2OK00jhyXTdOkO9ow4RyFO6nk84P0miSPKaqnU_V7OnQGmuc6UwRKEGG7Y2MhBRuuRyrlCbhllobu6LkyjVHSCDHWutRML24tDNemFl6rxkjgJQWAxEERJFpAiVg-oaDXRIzO8Ds790AOxq-kSIaEm0s4giTdyHi3qvQ0miUKjPF4dPfJomwnW1NlbCRKcZ7ZxUZo1TGE9HBTjjUyJrsBnJyV39Vxqh-55FYlxEoMKi4CyoDIKSagtB6AkkwDmDAdByAQHgM5w0LlZDYDc-gBgAA9deOBhE4AXiAXE2U4jEhAOFmLpjhHxfAFg20-KItpeXplo-shJHJdS8vaLmWkkRai1Ft8mWRR-kkOKCADAYu1axJiTrmIgA">
                                        <button type="submit" class="fi fi-edit face-one-code-source-tool-preview-submit" ></button>
                                    </form>
                                <span class="face-one-code-source-tool-copy fi fi-copy"></span>
                            </div>
                            <pre><code class="lang-js"><span class="hljs-keyword">var</span> BetterAPI = <span class="hljs-built_in">require</span>(<span class="hljs-string">'better-api'</span>)
<span class="hljs-keyword">var</span> $ = <span class="hljs-built_in">require</span>(<span class="hljs-string">'jquery'</span>)
<span class="hljs-keyword">var</span> message = <span class="hljs-built_in">require</span>(<span class="hljs-string">'face-message'</span>)
<span class="hljs-keyword">var</span> api = <span class="hljs-keyword">new</span> BetterAPI({
    <span class="hljs-attr">defaultSettings</span>: {
        <span class="hljs-attr">dataType</span>: <span class="hljs-string">'json'</span>
    },
    <span class="hljs-attr">loading</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">isLoading, failArg</span>) </span>{
        <span class="hljs-keyword">if</span> (isLoading) {
            message.loadingBar.show(<span class="hljs-number">2</span>)
        }
        <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">switch</span> (failArg[<span class="hljs-number">1</span>]) {
                <span class="hljs-keyword">case</span> <span class="hljs-string">'abort'</span>:

                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-literal">undefined</span>:
                    message.loadingBar.hide()
                    <span class="hljs-keyword">break</span>
                <span class="hljs-keyword">default</span>:
                    message.loadingBar.fail()
            }
        }
    },
    <span class="hljs-attr">input</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req</span>) </span>{
        <span class="hljs-keyword">return</span> req
    },
    <span class="hljs-attr">output</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res, req</span>) </span>{
        <span class="hljs-keyword">return</span> res
    },
    <span class="hljs-attr">fetch</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data, settings, callback</span>) </span>{
        settings.data = data
        <span class="hljs-keyword">return</span> $.ajax(settings)
                .done(callback.net.done)
                .fail(callback.net.fail)
                .always(callback.after)
    },
    <span class="hljs-attr">defaultCallback</span>: {
        <span class="hljs-attr">net</span>: {
            <span class="hljs-attr">fail</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">jqXHR, textStatus</span>) </span>{
                <span class="hljs-keyword">switch</span>(textStatus) {
                    <span class="hljs-keyword">case</span> <span class="hljs-string">'timeout'</span>:
                        message.error(<span class="hljs-string">'网络超时'</span>)
                    <span class="hljs-keyword">break</span>
                    <span class="hljs-keyword">case</span> <span class="hljs-string">'abort'</span>:
                    <span class="hljs-keyword">break</span>
                    <span class="hljs-keyword">default</span>:
                        message.error(<span class="hljs-string">'网络错误'</span>)
                }

            }
        }
    },
    <span class="hljs-attr">judgeResponseType</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) </span>{
        <span class="hljs-keyword">return</span> res.status
    },
    <span class="hljs-attr">defaultResponseType</span>: {
        <span class="hljs-attr">pass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            message.success(<span class="hljs-string">'操作成功'</span>)
        },
        <span class="hljs-attr">fail</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) </span>{
            message.error(<span class="hljs-string">'fail:'</span> + res.msg)
        },
        <span class="hljs-attr">error</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) </span>{
            message.error(<span class="hljs-string">'error:'</span> + res.msg)
        }
    }
})
<span class="hljs-keyword">var</span> apiPass = api.create({
    <span class="hljs-attr">settings</span>: {
        <span class="hljs-attr">url</span>: <span class="hljs-string">'http://118.25.125.213:9823/onface/echo/mock/pass'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'get'</span>
    }
})
<span class="hljs-keyword">var</span> apiFail = api.create({
    <span class="hljs-attr">settings</span>: {
        <span class="hljs-attr">url</span>: <span class="hljs-string">'http://118.25.125.213:9823/onface/echo/mock/fail'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'get'</span>
    }
})
<span class="hljs-keyword">var</span> apiNetFail = api.create({
    <span class="hljs-attr">settings</span>: {
        <span class="hljs-attr">url</span>: <span class="hljs-string">'/404'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'get'</span>
    }
})
<span class="hljs-keyword">var</span> apiDelay = api.create({
    <span class="hljs-attr">settings</span>: {
        <span class="hljs-attr">url</span>: <span class="hljs-string">'http://118.25.125.213:9823/onface/echo/mock/pass?$delay=1000'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'get'</span>
    }
})
$(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    $(<span class="hljs-string">'#jquery-pass'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        apiPass(
            <span class="hljs-comment">// data</span>
            {
                <span class="hljs-attr">name</span>: <span class="hljs-string">'nimo'</span>
            },
            <span class="hljs-comment">// callback</span>
            {
                <span class="hljs-attr">pass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
                    message.success(<span class="hljs-string">'操作成功'</span>)
                },
                <span class="hljs-attr">fail</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) </span>{
                    message.error(res.msg)
                }
            }
        )
    })
    $(<span class="hljs-string">'#jquery-fail'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        apiFail(
            <span class="hljs-comment">// data</span>
            {
                <span class="hljs-attr">name</span>: <span class="hljs-string">'nimo'</span>
            },
            <span class="hljs-comment">// callback</span>
            {
                <span class="hljs-attr">pass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
                    alert(<span class="hljs-string">'操作成功'</span>)
                },
                <span class="hljs-attr">fail</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) </span>{
                    message.error(res.msg)
                }
            }
        )
    })
    $(<span class="hljs-string">'#jquery-fail-detailAction'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        apiFail(
            <span class="hljs-comment">// data</span>
            {
                <span class="hljs-attr">name</span>: <span class="hljs-string">'nimo'</span>
            },
            <span class="hljs-comment">// callback</span>
            {
                <span class="hljs-attr">pass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
                    message.success(<span class="hljs-string">'操作成功'</span>)
                },
                <span class="hljs-attr">fail</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) </span>{
                    <span class="hljs-keyword">this</span>.defaultAction()
                    message.error(<span class="hljs-string">'More message (fail)'</span>)
                }
            }
        )
    })
    $(<span class="hljs-string">'#jquery-net-fail'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        apiNetFail()
    })
    $(<span class="hljs-string">'#jquery-net-fail-custom'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        apiNetFail({}, {}, {
            <span class="hljs-attr">net</span>: {
                <span class="hljs-attr">fail</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
                    message.error(<span class="hljs-string">'（自定义）网络错误'</span>)
                }
            }
        })
    })
    $(<span class="hljs-string">'#jquery-net-fail-defaultAction'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        apiNetFail({}, {}, {
            <span class="hljs-attr">net</span>: {
                <span class="hljs-attr">fail</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
                    <span class="hljs-keyword">this</span>.defaultAction()
                    message.error(<span class="hljs-string">'More message ($net.fail)'</span>)
                }
            }
        })
    })
    $(<span class="hljs-string">"#jquery-abort"</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        <span class="hljs-keyword">var</span> api = apiDelay({}, {}, {
            <span class="hljs-attr">net</span>: {
                <span class="hljs-attr">fail</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
                    <span class="hljs-built_in">console</span>.log(<span class="hljs-built_in">arguments</span>)
                }
            }
        })
        api.abort()
    })
    $(<span class="hljs-string">'#jquery-loading'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
        apiDelay({}, {}, {
            <span class="hljs-attr">loading</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">isLoading</span>) </span>{
                <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'isLoading'</span>, isLoading)
            }
        })
    })
})

</code></pre>
                        </div>
                        
                    </div>
                                
<h2 id="axios" ><a class="markrun-anchor" href="../Users/nimo/Documents/git/better-api/#axios"><span class="markrun-anchor-link"></span></a>axios</h2>
    <div class="face-one-code   face-one-code--run  face-one-code--side">
                        <div class="face-one-code-F-view">
                            <div class="face-one-code-example">
                                <button id="axios-timeout">timeout</button> <button id="axios-404">not found</button> <button id="axios-abort">abort</button>
                            </div>
                            <div class="face-one-code-info">
                                <div class="face-one-code-info-title">axios</div>
                                <div class="face-one-code-info-desc">
                                    
                                </div>
                                <span class="face-one-code-info-switchCode fi fi-ellipsis"></span>
                            </div>
                        </div>
                        <div class="face-one-code-source"  >
                            <div class="face-one-code-source-tool">
                                <form class="face-one-code-source-tool-preview" action="https://codesandbox.io/api/v1/sandboxes/define" method="post" target="_blank" >
                                        <input type="hidden" name="parameters" value="N4IgZglgNgpgziAXKCA7AJjAHgOgBYAuAtlEqAMYD2qBMNSIAPAEYCuBB1ABBOgLwAdEAEMsESnAC0BCERiV2QgHwy5CgowD0bDtSVcW7Tqh78ho8VIAsABivLUlAlzAKMWncf2HdJ3oJExCUlhZkoAJwJlUIiNbSM9EABfABoQNExcACsEZBAqGjoCBgA3YXCuACEYDhhwgEEABQBJLj4ucJgAR1YIToAKAHJmGtpwkIAHCEGASgFUMoqLCTaO7t6BweW4WfnFrjk4OGEAcxhVzp6-mCGwYXIYSUPjs92F8q4AYWFUB6gAFUoAGs6Kttjhvr8YADgXR5nsPsIpqtUDAAO5VUZ1JrNfrAeZcQlcTB3VhQAgAZVGaBOcEQXHxJiJzPQwgIwn-AE8JjB6YMctRBgSialhYSoJRhOgafSwKxfjJuP0IHAADKS6WoE4pFzCaD1cInGYMsXMriaTRcApwSiwHASk79O76w1zJlm82WiBgLjKtUamnGxkewkWs3PU4we0BrWVco4OB4Sho_oAJjdIc9XCSpuZYbDzqgBpOqwA2lkugANAASACUdbQsJT2QRWHAdXVwhF_ngu2jUABdXNEsPQuDnb2-wvF0sARgHXAAhHx2lswpFZib3Waw8yI2do1KaXHwjhC_0MyGwznt3nLaOoOOeD6nXqi4a5wuV6uYhug8PQ3vS093gF4owlI9Y3jPBeBuS8PXzS0b0zB8n2DK9gKJfdwJjE4T3wWCLwArNkJFFJTTQCZ2FleVyEVEx-kuf9byJTpW3CExLlNUVt3UKiCBohVxAYzp2zWLpmMzNjWA4tY4G48jtzAGpyDwQS6OE31WXZHVxw4GkxPIYQoCgZh7iBSSQz0mQtTgHBtOEVYHOI6yDJwOQCCTdBVlc2ycAIbko04ABVCYeXCb5xyIljCUnfpfNpdyai8toVy4QYAHEAFF_k3dDM0ArgErsmSoFWAADAASYBipwUqkgAfmqro7LgAhwhpb1OXi6k_IcmYknK4jmVqiZymEIg4CctlhGGolMFgWgit6xLnJi7NiMWrhtk-Og_hcla7KMqEYRBEx2lRDFIT-QEzv6fpjr-Y0-H0fKCp2vboVWR7oWIpI3WI7Yev02z4LNfy8DoJ1aPoxj4BmN7MyMkyzPIIEcFRAh7OoG5RPsmawaR4zTPMnBhDAMZoszf7iJwIyCFU6GhOofpOwiBG5sJZGSbRsmKbqKmCtil82dPUSJmoJ8AB8pa4UWcEuVh4GcGW5fCLtT2w1Kf3XAg8s5s1udR9HMbPN9WfV9mDdIoWx3ORGha4Ty-zVjXrb-wnWJqGSTAdj1fwE31nteg3mTigKeUoH0PpO7X0rlZnUH19bHe2oI4F2k6hgDt5U-ZG2CoL_P4W3HiWRgUlyW-FHzPpP2uExuuDcLdT6N9UXLLz59fU0VR5HYTR_OVi2NaSo5IxmTuu5A8eD1FoZAEV_QAdv0AUNjADfTXPp6Lx27e7_pNADwfaDakeIjHsDJ63aed0tH6ysV5XQ5FJ_CV3-vU-wnB58GZfAExUwB76MGFwAA1K7M-2FPZC23h6aBG1S6KWZFkVg6Azi1ngBLVA44uQ8lbppOGcAp7MmkrJPGbU2RtgUqaEkwgyQEDQXADBWDApN3WmNI4uClSEJDJ_OArByAPCOEMQAsyaAB15QACEaAHylTeMCEEhhbi4GGeDRJcI9J_b-LcgGgLxpNI0f1ZEelFhwkS8Mr6OzUZbcIQxDGaLku5OAuj1oFxvDTVACIlhTH-LIfuzh2hIggHTTobIbhvWKiwzMpU-SEAIBMRAFpZyzgABw4FTAAVhwLOVJyTZwAGZEAAE4EmpmyZoagdwHiaBgKpSgmgiCUDRpoNhcAmoLWEJyPgs4bCdMGPos0EdeTpTOHrHpzI-7qHpLYGw3F5guPmJVIYABibY0gvHqFmDgFmgxyBQAgGjbpCjE5B1MYSPxni1DsGijM947iIAADknCuHlN5XxUwAkwCCXiU0oSjlmgielCpFjgrhCgN04ifS-SDJBetUZ1EuATKmagS5czBiLPTpIWwVg1kbK2TsoEeyE4aU4d8vxdyCAPIwBcgGrirnbSmPUXWYIXnkECbQD524vn11-YMKJMS4mJOSWkjJaTUw5PyYU4ppT7gwAqVUmpdSgQNOEEcZp0JWntM6TYSFmYwUDJqEKUu0zKWzIWUsnOMx1moCGNi3ZOp8VtwvN8_YlwYBth8TSiAdLYj9GIsAMuIYfXDKJO_IkEFNQnCMb6FU6pILal1C6I03zU5xUjbhFRedP4huPPGRMyZBZd1gZmN-L9wygUjIeUN-EYKYFzXnfNz9HGmjBk6l1ZNdbRQNfMZIaQxpo1LQKVAZB8jUFoPQPImAeQYD2hAeAA7jjKUkNgYd6AGAAD1sk4BsDgFJIA0jbBXRuvlNht3gElU8EtZw93pPSUespjw-m5BAMu_d66j0ViVuETkK611rtnEekYtRxh-IYBu79yQkhgaSEAA">
                                        <button type="submit" class="fi fi-edit face-one-code-source-tool-preview-submit" ></button>
                                    </form>
                                <span class="face-one-code-source-tool-copy fi fi-copy"></span>
                            </div>
                            <pre><code class="lang-js"><span class="hljs-keyword">var</span> BetterAPI = <span class="hljs-built_in">require</span>(<span class="hljs-string">'better-api'</span>)
<span class="hljs-keyword">var</span> axios = <span class="hljs-built_in">require</span>(<span class="hljs-string">'axios'</span>)
<span class="hljs-keyword">var</span> message = <span class="hljs-built_in">require</span>(<span class="hljs-string">'face-message'</span>)
<span class="hljs-keyword">var</span> CancelToken = axios.CancelToken

<span class="hljs-keyword">var</span> api = <span class="hljs-keyword">new</span> BetterAPI({
    <span class="hljs-attr">defaultSettings</span>: {
        <span class="hljs-attr">dataType</span>: <span class="hljs-string">'json'</span>
    },
    <span class="hljs-attr">loading</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">isLoading, failArg</span>) </span>{
        <span class="hljs-comment">// console.log(failArg)</span>
        <span class="hljs-comment">// if (isLoading) {</span>
        <span class="hljs-comment">//     message.loadingBar.show(2)</span>
        <span class="hljs-comment">// }</span>
        <span class="hljs-comment">// // failArg = [jqXHR, textStatus, errorThrown]</span>
        <span class="hljs-comment">// else if (failArg[1] !== 'abort') {</span>
        <span class="hljs-comment">//     message.loadingBar.fail()</span>
        <span class="hljs-comment">// }</span>
        <span class="hljs-comment">// // else if (failArg[1] === 'abort') {</span>
        <span class="hljs-comment">// //     message.loadingBar.hide()</span>
        <span class="hljs-comment">// // }</span>
        <span class="hljs-comment">// else {</span>
        <span class="hljs-comment">//     message.loadingBar.hide()</span>
        <span class="hljs-comment">// }</span>
    },
    <span class="hljs-attr">input</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req</span>) </span>{
        <span class="hljs-keyword">return</span> req
    },
    <span class="hljs-attr">output</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res, req</span>) </span>{
        <span class="hljs-keyword">return</span> res
    },
    <span class="hljs-attr">fetch</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data, settings, callback</span>) </span>{
        settings.data = data
        settings.method = settings.type.toUpperCase()
        <span class="hljs-keyword">if</span> (settings.method === <span class="hljs-string">'GET'</span>) {
            <span class="hljs-comment">// settings.url = `${settings.url}?${qs.stringify(settings.data)}`</span>
            settings.params = data
            <span class="hljs-keyword">delete</span> settings.data
        }
        <span class="hljs-keyword">let</span> axiosCencel
        settings.cancelToken = <span class="hljs-keyword">new</span> CancelToken(<span class="hljs-function">(<span class="hljs-params">cancel</span>) =&gt;</span> {
            axiosCencel = cancel
        })

        axios(settings)
        .then(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>)</span>{
            callback.net.done(res.data)
            callback.after()
        })
        .catch(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">error</span>)</span>{
            callback.after()
            <span class="hljs-keyword">if</span> (error.response || error.request || error.message === <span class="hljs-string">'abort'</span>) {
                callback.net.fail(error)
            }
            <span class="hljs-keyword">else</span> {
                <span class="hljs-keyword">throw</span> error
            }
        })
        <span class="hljs-keyword">return</span> {
            <span class="hljs-attr">abort</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> axiosCencel === <span class="hljs-string">'function'</span>) {
                    axiosCencel(<span class="hljs-string">'abort'</span>)
                }
            }
        }

    },
    <span class="hljs-attr">defaultCallback</span>: {
        <span class="hljs-attr">net</span>: {
            <span class="hljs-attr">fail</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">error</span>) </span>{
                <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/timeout/</span>.test(error.message)) {
                     message.error(<span class="hljs-string">'网络超时'</span>)
                }
                <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/abort/</span>.test(error.message)) {
                    <span class="hljs-comment">// cancel request</span>
                }
                <span class="hljs-keyword">else</span> {
                    message.error(<span class="hljs-string">'网络错误'</span> + error.message)
                }
            }
        }
    },
    <span class="hljs-attr">judgeResponseType</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) </span>{
        <span class="hljs-keyword">return</span> res.status
    },
    <span class="hljs-attr">defaultResponseType</span>: {
        <span class="hljs-attr">pass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            message.success(<span class="hljs-string">'操作成功'</span>)
        },
        <span class="hljs-attr">fail</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) </span>{
            message.error(<span class="hljs-string">'fail:'</span> + res.msg)
        },
        <span class="hljs-attr">error</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) </span>{
            message.error(<span class="hljs-string">'error:'</span> + res.msg)
        }
    }
})

<span class="hljs-keyword">var</span> apiTimeout = api.create({
    <span class="hljs-attr">settings</span>: {
        <span class="hljs-attr">url</span>: <span class="hljs-string">'http://118.25.125.213:9823/onface/echo/mock/pass?$delay=1000'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'get'</span>,
        <span class="hljs-attr">timeout</span>: <span class="hljs-number">400</span>
    }
})

$(<span class="hljs-string">'#axios-timeout'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    apiTimeout()
})

<span class="hljs-keyword">var</span> apiNotfound = api.create({
    <span class="hljs-attr">settings</span>: {
        <span class="hljs-attr">url</span>: <span class="hljs-string">'/errorUrl'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'get'</span>,
        <span class="hljs-attr">timeout</span>: <span class="hljs-number">400</span>
    }
})

$(<span class="hljs-string">'#axios-404'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    apiNotfound()
})


<span class="hljs-keyword">var</span> apiAbort = api.create({
    <span class="hljs-attr">settings</span>: {
        <span class="hljs-attr">url</span>: <span class="hljs-string">'http://118.25.125.213:9823/onface/echo/mock/pass?$delay=1000'</span>,
        <span class="hljs-attr">type</span>: <span class="hljs-string">'get'</span>
    }
})


$(<span class="hljs-string">'#axios-abort'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> reqeust = apiAbort(
        {},
        {},
        {
            <span class="hljs-attr">loading</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">isLoading, failArg</span>) </span>{
                <span class="hljs-keyword">if</span> (isLoading) {
                    message.loadingBar.show()
                }
                <span class="hljs-keyword">else</span> {
                    message.loadingBar.hide()
                }
            }
        }
    )
    reqeust.abort()

})

</code></pre>
                        </div>
                        
                    </div>
                                
<h2 id="check" ><a class="markrun-anchor" href="../Users/nimo/Documents/git/better-api/#check"><span class="markrun-anchor-link"></span></a>check</h2><blockquote>
<p>校验接口返回格式是非常重要的，虽然写校验代码需要时间。但是“某些情况下”相比调试找bug的时间会少很多。</p>
</blockquote>

    <div class="face-one-code   face-one-code--run  face-one-code--side">
                        <div class="face-one-code-F-view">
                            <div class="face-one-code-example">
                                <button id="check-account" >check-account</button> <button id="check-fail" >check-fail</button>
                            </div>
                            <div class="face-one-code-info">
                                <div class="face-one-code-info-title">check</div>
                                <div class="face-one-code-info-desc">
                                    
                                </div>
                                <span class="face-one-code-info-switchCode fi fi-ellipsis"></span>
                            </div>
                        </div>
                        <div class="face-one-code-source"  >
                            <div class="face-one-code-source-tool">
                                <form class="face-one-code-source-tool-preview" action="https://codesandbox.io/api/v1/sandboxes/define" method="post" target="_blank" >
                                        <input type="hidden" name="parameters" value="N4IgZglgNgpgziAXKCA7AJjAHgOgBYAuAtlEqAMYD2qBMNSIAPAEYCuBB1ABBOgLwAdEOTwxyAawC0AQ3JVWNIVwB8IsVNnyajAPRsO1ZVxbtOqHvyFqJksNOhLVom3ei79Z5SAC-AGhBomLgAVgjIwtS09IggAG7SAE5cAEIwHDAJAIIACgCSXHxcCTAAjqwQxQAUAOTMabQJMgAOENUAlAKo8UlE8HDSAOYwXAVFpeVV1XbkMJK9cP1D7Z3dXAAko8VlFTA1wWUZAJ7LqDo6XIQETXCIZ9TTMDgDEAR4rMw4EJQ6BIdN8DoVokuAAVP7wTbjHY1B6SX7_ODtSrACBwABKUOK6EQXAICVYMG8HS6wOAnRGIzgeLQA18XGYlEoUF8qFYRDqCTpiQS0kOvnJFOoMAA8mAuQkeYdRXTKMxgmICPzzIK5QrpVw4HhpP9Ot5RmCEUCkqhKAQMdssQaIYUthNdlNZLN4fAkSj0ZiYNiuHYoHBCcSjVxtRBRqgYAB3FL1DI5XLIgUjaziHFgBTkAhfcyVYpwOlbOl-jg0uBtLhk5UUikQMBcSqFjOoAZwHCsBJQLgAQj4hWqcEovQA-nB_uQINIoAPW1B2mWE5X51bm0nKnP52vZxX11vKQRpARWDcuELRZUANrVJrSBbVOkO6DVAC6xO3678q5fY1z75f1WkwWkWA3t-271sWLZtsBlbPq-c5vpumB2KwUAEAAyvUxY4uWW7oHu0hWji1ShNQ1SwUqlZQJQ0joDSKZphm3CVKiAAylHUY2dKuFAmQJAMpZYeu1a1sxrE0nxkEUvMiyPBRVE0skiQ4JqlDhpUABM0Frt4wEwL6wz8S-cDhi8Ii1px3EDKeACMT4bh-87kFewy_gyCQENUiCdOJL7MMU0jiAA3F59mOVwCgIWgnoeZudmVpJgzSSJjbyQk-C8LsGkxZWPkwH5QWVgh0hIQQUWZWucVDDgMlsQMyU4JxlQZVuWnRRSzWVnBlZoE07C0ag6aZrWWxiS1IzFPuCTmFspFzpQ7DdcV3p0QN2bwHmpTDVuY2tpN8DTZuYBpCIvX9QxOG7gW6GNrmXAOVAUDMLI4gbeuoFXTgZ3SKMH3AVtE3rDgf4AXWl1No1H7vUKlS3fdj04GGBAQ2GYMvnV9hQFD44wxIcNpKj0DI9uANQOGvJwBjd0Pdj0hgA0GUdRSBVFQAwpjlPJrZ67w5hQWccd9FZvsAAaAASaJ0rQWCobu-4lhzmWGcZeCVBLUt7gez2lRSDl-lw1QZr0s1uSVmvruVjwZAklAJDUgCK_oAO36AKGxgBvpicJsUtluUjTF2tOdILlG3l64e-IgdrozyHG27sV9PFOAW1btt24AmKmAPfRrulc1QVtTBm70yMwSsOgQwYsO1B-vhi19fzg3wBr86_TtzZUmrcB7flMCIchJdNGXMAV_p86XgsfPLXXW5m4prByH0NSALMmgA68oACEaAPlK6eaWR6685XJ1ZjmY-mzHFXx9bd5QIg1RcAA1J-OBEHAvHAXn87HyPDF73L24T8fNQvxf185rfe-BNs4jGakSQMwZMhyFmjQUYwYcDkF8rQeMm5XpNm5l7KcBFLhNFuDoSylkAAcOBVIAFYcCWTISQyyABmRAABOQhqkaE6HuI6HQYg8DfCIJQCQOhNAwLchvNczoCJDDcm3LWzh2YD0rEPQ8qYq7LRzGtEoF0ixXX3muVYwANTUnYvSRkzJWTsgyOKSUwjSrHjFEGCUvJ1SynlOmSxmVHFqhsZqbUMBQ5cD1DaD0MJHRwnBIiNoyJUTmjtF6PEBJwFe0rKsE0ZoPToEhBae0sJnShPCe6dJXofR-jiXZRcCDpErnieuWRpUPo4k8f8FBUd5y0CpJZWp-jaQ-K3M0ggqkcRJMiTsdAJSqQJBpC4qOB4MioGkL0Npoz2KdPXPFPpbIOTjLdugfs9hUCHm5PYsAdZ2ltHWSbJolsnEEF2XYqUBzFkGS1PUqpjS1zTNmXo-ZHSKnPNCm2OZNI7nbiKd8rgxyAWVnIK2YoNBsjnIVLUh5uwnnPNeTAP5Cyvkmywe8_5GK7JArdvimKT87IqJ8b-f8gETlbjQc2KcQVgGwV1AGVAawagAGIkwyGgQoNybQcDUBqOQKAEAJA3m3tXBqH9IHcpoA1JlnkSRJGDAAMTRnAloCCkGIrnDSjBW4sXVBwXgghxCqGUPIapWhDCmEsLYTMDhIhuG8PEDoTiQEvaiN1uIkiudLFJj1ZvNGr9d6rTGGojUINZZIsrCU5cPjo0fjvgMNFAwfHEo_KS3FFJyUAXdZrGl4EoD0sfoy1AcTWXVA5dI2waN2j8tQIK4VoqOJLQYnXFVaM5VluJD4fwl4JCxyIqgMgEQaB0AICOzA_wMB0FHPAEd_QDqSGwFEdADAAB6NCcAAAYcCkJAP4ACXwwggHXbuohO6D3gCCWbDd56KFXsySEu9FDL3-H2ASBIhwN1bq3ZZK9dR0iNGDAwXdf6fDeEg94IAA">
                                        <button type="submit" class="fi fi-edit face-one-code-source-tool-preview-submit" ></button>
                                    </form>
                                <span class="face-one-code-source-tool-copy fi fi-copy"></span>
                            </div>
                            <pre><code class="lang-js"><span class="hljs-keyword">var</span> BetterAPI = <span class="hljs-built_in">require</span>(<span class="hljs-string">'better-api'</span>)
<span class="hljs-keyword">var</span> message  = <span class="hljs-built_in">require</span>(<span class="hljs-string">'face-message'</span>)
<span class="hljs-keyword">var</span> $ = <span class="hljs-built_in">require</span>(<span class="hljs-string">'jquery'</span>)
<span class="hljs-comment">// https://onface.github.io/types/</span>
<span class="hljs-keyword">var</span> Types = <span class="hljs-built_in">require</span>(<span class="hljs-string">'face-types'</span>)({<span class="hljs-attribute">isRequired</span>: <span class="hljs-literal">true</span>})
<span class="hljs-title">var</span> {
    <span class="hljs-built_in">string</span>, <span class="hljs-built_in">bool</span>,number, array,
    oneOf, arrayOf, object,
    objectOf, shape
} = Types
<span class="hljs-keyword">var</span> notRequiredTypes = <span class="hljs-built_in">require</span>(<span class="hljs-string">'face-types'</span>)({<span class="hljs-attribute">isRequired</span>: <span class="hljs-literal">false</span>})

<span class="hljs-keyword">var</span> api = <span class="hljs-keyword">new</span> BetterAPI({
    <span class="hljs-attribute">check</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res, req, settings</span>) </span>{
        <span class="hljs-keyword">if</span> (settings.url !== <span class="hljs-string">'some_special_url'</span>) {
            Types.check(
                {
                    <span class="hljs-attribute">status</span>: oneOf([<span class="hljs-string">'pass'</span>, <span class="hljs-string">'fail'</span>])
                },
                res,
                <span class="hljs-string">'ajax'</span>,
                settings.url
            )
        }
    },
    <span class="hljs-attribute">defaultSettings</span>: {
        <span class="hljs-attribute">dataType</span>: <span class="hljs-string">'json'</span>
    },
    <span class="hljs-attribute">loading</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">isLoading, failArg</span>) </span>{
        <span class="hljs-keyword">if</span> (isLoading) {
            message.loadingBar.show(<span class="hljs-number">2</span>)
        }
        <span class="hljs-title">else</span> {
            <span class="hljs-keyword">switch</span> (failArg[<span class="hljs-number">1</span>]) {
                <span class="hljs-keyword">case</span> <span class="hljs-string">'abort'</span>:

                    <span class="hljs-keyword">break</span>;
                <span class="hljs-keyword">case</span> <span class="hljs-attribute">undefined</span>:
                    message.loadingBar.hide()
                    <span class="hljs-keyword">break</span>
                <span class="hljs-attribute">default</span>:
                    message.loadingBar.fail()
            }
        }
    },
    <span class="hljs-attribute">input</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">req</span>) </span>{
        <span class="hljs-keyword">return</span> req
    },
    <span class="hljs-attribute">output</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res, req</span>) </span>{
        <span class="hljs-keyword">return</span> res
    },
    <span class="hljs-attribute">fetch</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data, settings, callback</span>) </span>{
        settings.data = data
        <span class="hljs-keyword">return</span> $.ajax(settings)
                .done(callback.net.done)
                .fail(callback.net.fail)
                .always(callback.after)
    },
    <span class="hljs-attribute">defaultCallback</span>: {
        <span class="hljs-attribute">net</span>: {
            <span class="hljs-attribute">fail</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">jqXHR, textStatus</span>) </span>{
                <span class="hljs-keyword">switch</span>(textStatus) {
                    <span class="hljs-keyword">case</span> <span class="hljs-string">'timeout'</span>:
                        message.error(<span class="hljs-string">'网络超时'</span>)
                    <span class="hljs-keyword">break</span>
                    <span class="hljs-keyword">case</span> <span class="hljs-string">'abort'</span>:
                    <span class="hljs-keyword">break</span>
                    <span class="hljs-attribute">default</span>:
                        message.error(<span class="hljs-string">'网络错误'</span>)
                }

            }
        }
    },
    <span class="hljs-attribute">judgeResponseType</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) </span>{
        <span class="hljs-keyword">return</span> res.status
    },
    <span class="hljs-attribute">defaultResponseType</span>: {
        <span class="hljs-attribute">pass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            message.success(<span class="hljs-string">'操作成功'</span>)
        },
        <span class="hljs-attribute">fail</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) </span>{
            message.error(<span class="hljs-string">'fail:'</span> + res.msg)
        },
        <span class="hljs-attribute">error</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res</span>) </span>{
            message.error(<span class="hljs-string">'error:'</span> + res.msg)
        }
    }
})
<span class="hljs-keyword">var</span> apiAccount = api.create({
    <span class="hljs-attribute">settings</span>: {
        <span class="hljs-attribute">url</span>: <span class="hljs-string">'http://118.25.125.213:9823/onface/echo/mock/account'</span>,
        <span class="hljs-attribute">type</span>: <span class="hljs-string">'get'</span>
    },
    <span class="hljs-attribute">check</span>: {
        <span class="hljs-attribute">pass</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res, req, settings</span>) </span>{
            <span class="hljs-title">var</span> { <span class="hljs-built_in">string</span>, <span class="hljs-built_in">bool</span>,number, array,
                  oneOf, arrayOf, object,
                  objectOf, shape
                } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'face-types'</span>)({<span class="hljs-attribute">isRequired</span>: <span class="hljs-literal">true</span>})
            <span class="hljs-keyword">var</span> notRequired = <span class="hljs-built_in">require</span>(<span class="hljs-string">'face-types'</span>)({<span class="hljs-attribute">isRequired</span>: <span class="hljs-literal">false</span>})
            Types.check(
                {
                    <span class="hljs-attribute">data</span>: shape({
                        <span class="hljs-attribute">test1</span>: <span class="hljs-built_in">string</span>,
                        <span class="hljs-attribute">test2</span>: notRequiredTypes.string,
                        <span class="hljs-attribute">username</span>: <span class="hljs-built_in">string</span>,
                        <span class="hljs-attribute">age</span>: number,
                        <span class="hljs-attribute">domains</span>: arrayOf(<span class="hljs-built_in">string</span>),
                        <span class="hljs-attribute">projects</span>: arrayOf(
                            shape({
                                <span class="hljs-attribute">name</span>: <span class="hljs-built_in">string</span>,
                                <span class="hljs-attribute">url</span>: <span class="hljs-built_in">string</span>
                            })
                        ),
                        <span class="hljs-attribute">currentProject</span>: shape({
                            <span class="hljs-attribute">name</span>: <span class="hljs-built_in">string</span>,
                            <span class="hljs-attribute">url</span>: <span class="hljs-built_in">string</span>
                        })
                    })
                },
                res,
                <span class="hljs-string">'ajax'</span>,
                settings.url
            )
        }
    }
})

$(<span class="hljs-string">'#check-account'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    apiAccount()
})

<span class="hljs-keyword">var</span> apiFail = api.create({
    <span class="hljs-attribute">settings</span>: {
        <span class="hljs-attribute">url</span>: <span class="hljs-string">'http://118.25.125.213:9823/onface/echo/mock/fail'</span>,
        <span class="hljs-attribute">type</span>: <span class="hljs-string">'get'</span>
    },
    <span class="hljs-attribute">check</span>: {
        <span class="hljs-attribute">fail</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">res, req, settings</span>) </span>{
            Types.check(
                {
                    <span class="hljs-attribute">msg</span>: <span class="hljs-built_in">string</span>
                },
                res,
                <span class="hljs-string">'ajax'</span>,
                settings.url
            )
        }
    }
})
$(<span class="hljs-string">'#check-fail'</span>).on(<span class="hljs-string">'click'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    apiFail()
})

</code></pre>
                        </div>
                        
                    </div></div>
</div>
</div>
</div>
<script>
Array.from(document.querySelectorAll('.face-one-nav-item-label')).forEach(function (node) {
    if (node.href) {
        var pathname = node.href.replace(/\?.*/, '')
        if (pathname === location.origin + location.pathname + location.hash) {
            node.setAttribute('class', node.getAttribute('class') + ' ' + 'face-one-nav-item-label--on')
        }
    }
})
var faceOneGetParent = function faceOneGetParent (el, className) {
   if (el.parentNode.nodeName.toLowerCase() === 'html') {
       return null
   }
   var parentClassName = el.parentNode.getAttribute('class')
   var classNames = ''
   if (parentClassName) {
       classNames = parentClassName.split(' ')
   }
   if (classNames.indexOf(className) !== -1) {
       return el.parentNode
   }
   else {
       return faceOneGetParent(el.parentNode, className)
   }
}
Array.from(document.querySelectorAll('.face-one-nav-item-group-item')).forEach(function (node) {
    addAvativeClass(node)
    function addAvativeClass (node)  {
        if (node.href) {
            var pathname = node.href.replace(/\?.*/, '')
            if (pathname === location.origin + location.pathname + location.hash) {
                node.setAttribute('class', node.getAttribute('class') + ' ' + 'face-one-nav-item-group-item--on')
                var parentNode = faceOneGetParent(node, 'face-one-nav-item--group')
                if (parentNode) {
                    parentNode.setAttribute('class', parentNode.getAttribute('class') + ' ' + 'face-one-nav-item--group-on')
                }
            }
        }
    }

})
</script>
<div class="face-one-foot">
    <div class="face-one-foot-F-inner">
        <div class="face-one-foot-group">
            <div class="face-one-foot-group-title">
                <span class="face-one-foot-group-title-icon fi fi-github"></span>
                Github
            </div>
            <div class="face-one-foot-group-item">
                <a href="https://github.com/onface/better-api" class="face-one-foot-group-item-link">better-api</a>
                - 项目源码
            </div>
        </div>
        <div class="face-one-foot-group">
            <div class="face-one-foot-group-title">
                <span class="face-one-foot-group-title-icon fi fi-link"></span>
                相关站点
            </div>
            <div class="face-one-foot-group-item">
                <a href="https://onface.github.io/component-spec">component-spec</a>
                - 组件规范
            </div>
            <div class="face-one-foot-group-item">
                <a href="https://github.com/onface/module" class="face-one-foot-group-item-link">module</a>
                - 开源项目脚手架
            </div>
            <div class="face-one-foot-group-item">
                <a href="https://onface.live/" class="face-one-foot-group-item-link">onface.live</a>
                - 资源集合
            </div>
        </div>
        <div class="face-one-foot-group">
            <div class="face-one-foot-group-title">
                <span class="face-one-foot-group-title-icon fi fi-team"></span>
                社区
            </div>
            <div class="face-one-foot-group-item">
                <a href="https://github.com/onface/better-api/issues" class="face-one-foot-group-item-link">Github issues</a>
            </div>
            <div class="face-one-foot-group-item">
                <a href="https://github.com/onface/better-api/issues/new" class="face-one-foot-group-item-link">提交bug</a>
            </div>
            <div class="face-one-foot-group-item" id="face-one-view-version">

            </div>

        </div>
        <div class="face-one-foot-copyright">
            <a href="../index.html" class="face-one-foot-copyright-title">
                <img src="theme/media/logo.svg" class="face-one-foot-copyright-title-logo" />
            </a>
        </div>
    </div>
</div>
<script>
PACKAGE_JSON = {
    name: "better-api",
    $repository: "better-api",
    version: "0.3.1",
}
</script>
<script>
    if (location.pathname === '/' + PACKAGE_JSON.$repository) {
        var url = [
            location.origin,
            '/' + PACKAGE_JSON.$repository + '/',
            location.search,
            location.hash
        ].join('')
        location.href = url
    }
</script>

<script src="theme/jquery.js"></script>
<script>delete window.$</script>
<script src="theme/face/face.js" ></script>
<script data-markrun-lastrun="true" src="jquery.demo.js?v=0.3.1"></script><script data-markrun-lastrun="true" src="axios.demo.js?v=0.3.1"></script><script data-markrun-lastrun="true" src="check.demo.js?v=0.3.1"></script></body>
</html>